<!DOCTYPE html>


<html lang="ja">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>RFC 6946 - Processing of IPv6 &#34;Atomic&#34; Fragments 日本語訳</title>

  
  <link rel="shortcut icon" type="image/x-icon" href="https://tex2e.github.io/rfc-translater/favicon.ico" />
  <link rel="stylesheet" href="./bootstrap/css/bootstrap.min.css">
  <link rel="stylesheet" href="master.css">
  <script src="index.js"></script>

</head>
<body>
  
  <nav class="navbar navbar-expand navbar-light bg-light">
    <a class="navbar-brand" href="index.html">RFC Trans</a>
    <div class="collapse navbar-collapse" id="navbarText">
      <div class="navbar-nav mr-auto">
        <a class="nav-item nav-link" href="draft/index.html">Draft</a>
        <a class="nav-item nav-link" href="contact.html">Contact</a>
        <a class="nav-item nav-link" href="../figs/html/index.html">Figs</a>
      </div>
      <div class="navbar-nav ml-auto">
        <span class="navbar-text"><small>@tex2e</small></span>
      </div>
    </div>
  </nav>

  <span id="rfc_number" class="hidden">6946</span>
  <div style="height: 1ex;"></div>
  <div class="jump-to-original-rfc-container">
    <a href="https://datatracker.ietf.org/doc/html/rfc6946">
      <button type="button" class="btn btn-light btn-sm">
        <span class="jump-to-original-rfc">Orig</span>
      </button>
    </a>
  </div>
  <div class="container">
    <div>
      <div class="alert alert-info" role="alert">
        <h4 class="alert-heading">RFC 6946 - Processing of IPv6 "Atomic" Fragments 日本語訳</h4>
        <span class="URL">原文URL :
          <a href="https://datatracker.ietf.org/doc/html/rfc6946">
            https://datatracker.ietf.org/doc/html/rfc6946
          </a>
        </span><br>
        <span class="title_ja">
          タイトル : <strong>RFC 6946 - IPv6「アトミック」フラグメントの処理</strong></span><br>
        <span class="updated_by">翻訳編集 : 自動生成</span><span id="rfc_status"></span><span id="rfc_wg"></span><br>
      </div>
      <div id="rfc_alert" class="hidden" role="alert">
        <div class="alert alert-danger">
          <span id="rfc_alert_obsoleted_by"></span>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-sm-12 col-md-12">
        <pre class="text text-monospace">
Internet Engineering Task Force (IETF)                           F. Gont
Request for Comments: 6946                           Huawei Technologies
Updates: 2460, 5722                                             May 2013
Category: Standards Track
ISSN: 2070-1721
        </pre>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-17">
Processing of IPv6 &#34;Atomic&#34; Fragments
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-17">
IPv6「アトミック」フラグメントの処理
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-0">
Abstract
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-0">
概要
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
The IPv6 specification allows packets to contain a Fragment Header without the packet being actually fragmented into multiple pieces (we refer to these packets as &#34;atomic fragments&#34;). Such packets are typically sent by hosts that have received an ICMPv6 &#34;Packet Too Big&#34; error message that advertises a Next-Hop MTU smaller than 1280 bytes, and are currently processed by some implementations as normal &#34;fragmented traffic&#34; (i.e., they are &#34;reassembled&#34; with any other queued fragments that supposedly correspond to the same original packet). Thus, an attacker can cause hosts to employ atomic fragments by forging ICMPv6 &#34;Packet Too Big&#34; error messages, and then launch any fragmentation-based attacks against such traffic. This document discusses the generation of the aforementioned atomic fragments and the corresponding security implications. Additionally, this document formally updates RFC 2460 and RFC 5722, such that IPv6 atomic fragments are processed independently of any other fragments, thus completely eliminating the aforementioned attack vector.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
IPv6仕様では、パケットが実際に複数の断片にフラグメント化されることなく、パケットにフラグメントヘッダーを含めることができます（これらのパケットを「アトミックフラグメント」と呼びます）。このようなパケットは通常、1280バイト未満のネクストホップMTUをアドバタイズするICMPv6「Packet Too Big」エラーメッセージを受信したホストによって送信され、一部の実装では通常の「断片化されたトラフィック」として処理されます（つまり、「同じ元のパケットに対応すると思われる他のキューに入れられたフラグメントと一緒に再構成されます）。したがって、攻撃者はICMPv6の「Packet Too Big」エラーメッセージを偽造することでホストにアトミックフラグメントを採用させ、そのようなトラフィックに対してフラグメント化ベースの攻撃を開始できます。このドキュメントでは、前述のアトミックフラグメントの生成と、対応するセキュリティへの影響について説明します。さらに、このドキュメントはRFC 2460とRFC 5722を正式に更新し、IPv6のアトミックフラグメントが他のフラグメントとは独立して処理されるようにして、前述の攻撃ベクトルを完全に排除しています。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-0">
Status of This Memo
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-0">
本文書の状態
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
This is an Internet Standards Track document.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
これはInternet Standards Trackドキュメントです。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
This document is a product of the Internet Engineering Task Force (IETF). It represents the consensus of the IETF community. It has received public review and has been approved for publication by the Internet Engineering Steering Group (IESG). Further information on Internet Standards is available in Section 2 of RFC 5741.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
このドキュメントは、IETF（Internet Engineering Task Force）の製品です。これは、IETFコミュニティのコンセンサスを表しています。公開レビューを受け、インターネットエンジニアリングステアリンググループ（IESG）による公開が承認されました。インターネット標準の詳細については、RFC 5741のセクション2をご覧ください。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
Information about the current status of this document, any errata, and how to provide feedback on it may be obtained at http://www.rfc-editor.org/info/rfc6946.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
このドキュメントの現在のステータス、エラータ、およびフィードバックの提供方法に関する情報は、http：//www.rfc-editor.org/info/rfc6946で入手できます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-0">
Copyright Notice
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-0">
著作権表示
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
Copyright (c) 2013 IETF Trust and the persons identified as the document authors. All rights reserved.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
Copyright（c）2013 IETF Trustおよびドキュメントの作成者として識別された人物。全著作権所有。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
This document is subject to BCP 78 and the IETF Trust&#39;s Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document. Please review these documents carefully, as they describe your rights and restrictions with respect to this document. Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
この文書は、BCP 78およびこの文書の発行日に有効なIETF文書に関するIETFトラストの法的規定（http://trustee.ietf.org/license-info）の対象となります。これらのドキュメントは、このドキュメントに関するあなたの権利と制限を説明しているため、注意深く確認してください。このドキュメントから抽出されたコードコンポーネントには、Trust Legal Provisionsのセクション4.eに記載されているSimplified BSD Licenseのテキストが含まれている必要があり、Simplified BSD Licenseに記載されているように保証なしで提供されます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-0">
Table of Contents
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-0">
目次
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-12">
        <pre class="text text-monospace toc">
   1. Introduction ....................................................2
   2. Terminology .....................................................4
   3. Generation of IPv6 Atomic Fragments .............................4
   4. Updating RFC 2460 and RFC 5722 ..................................5
   5. Security Considerations .........................................6
   6. Acknowledgements ................................................6
   7. References ......................................................7
      7.1. Normative References .......................................7
      7.2. Informative References .....................................7
   Appendix A. Survey of Processing of IPv6 Atomic Fragments by
               Different Operating Systems ............................8
        </pre>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2" id="1--Introduction">
1. Introduction
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
1. はじめに
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
[RFC2460] specifies the IPv6 fragmentation mechanism, which allows IPv6 packets to be fragmented into smaller pieces such that they fit in the Path-MTU to the intended destination(s). [RFC2460] allows fragments to overlap, thus leading to ambiguity in the result of the reassembly process, which could be leveraged by attackers to bypass firewall rules and/or evade Network Intrusion Detection Systems (NIDS) [RFC5722].
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
[RFC2460]はIPv6フラグメンテーションメカニズムを指定します。これにより、IPv6パケットを目的の宛先へのパスMTUに収まるように、より小さな断片にフラグメント化できます。 [RFC2460]はフラグメントのオーバーラップを許可するため、攻撃者がファイアウォールルールをバイパスしたり、ネットワーク侵入検知システム（NIDS）[RFC5722]を回避したりするために利用できる、再構成プロセスの結果に曖昧さをもたらします。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
[RFC5722] forbids overlapping fragments, specifying that when overlapping fragments are detected, all the fragments corresponding to that packet must be silently discarded.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
[RFC5722]オーバーラップフラグメントを禁止し、オーバーラップフラグメントが検出された場合、そのパケットに対応するすべてのフラグメントをサイレントに破棄する必要があることを指定します。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-0">
 As specified in Section 5 of [RFC2460], when a host receives an ICMPv6 &#34;Packet Too Big&#34; message advertising a &#34;Next-Hop MTU&#34; smaller than 1280 (the minimum IPv6 MTU), it is not required to reduce the assumed Path-MTU, but must simply include a Fragment Header in all subsequent packets sent to that destination. The resulting packets will thus not actually be fragmented into several pieces but will just include a Fragment Header with both the &#34;Fragment Offset&#34; and the &#34;M&#34; flag set to 0 (we refer to these packets as &#34;atomic fragments&#34;). IPv6/IPv4 translators employ the Fragment Identification information found in the Fragment Header to select an appropriate Fragment Identification value for the resulting IPv4 fragments.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-0">
[RFC2460]のセクション5で指定されているように、ホストが1280（最小IPv6 MTU）未満の「ネクストホップMTU」をアドバタイズするICMPv6「Packet Too Big」メッセージを受信する場合、想定されるパスを減らす必要はありません。 MTU。ただし、その宛先に送信される後続のすべてのパケットにフラグメントヘッダーを含める必要があります。したがって、結果のパケットは実際にはいくつかに断片化されず、「フラグメントオフセット」と「M」フラグの両方が0に設定されたフラグメントヘッダーが含まれます（これらのパケットを「アトミックフラグメント」と呼びます）。 IPv6 / IPv4トランスレータは、フラグメントヘッダーにあるフラグメント識別情報を使用して、結果のIPv4フラグメントに適切なフラグメント識別値を選択します。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
While these packets are really atomic fragments (they can be processed by the IPv6 module and handed to the upper-layer protocol without waiting for any other fragments), many IPv6 implementations process them as regular fragments. Namely, they try to perform IPv6 fragment reassembly with the atomic fragment and any other fragments already queued with the same set {IPv6 Source Address, IPv6 Destination Address, Fragment Identification}. For example, in the case of IPv6 implementations that have been updated to support [RFC5722], if a fragment with the same {IPv6 Source Address, IPv6 Destination Address, Fragment Identification} is already queued for reassembly at a host when an atomic fragment is received with the same set {IPv6 Source Address, IPv6 Destination Address, Fragment Identification}, and both fragments overlap, all the fragments will be silently discarded.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
これらのパケットは実際にはアトミックフラグメントです（他のフラグメントを待たずにIPv6モジュールで処理し、上位層プロトコルに渡すことができます）が、多くのIPv6実装はそれらを通常のフラグメントとして処理します。つまり、アトミックフラグメントと同じセット{IPv6送信元アドレス、IPv6宛先アドレス、フラグメント識別}で既にキューに入れられている他のフラグメントを使用して、IPv6フラグメントの再構成を実行しようとします。たとえば、[RFC5722]をサポートするように更新されたIPv6実装の場合、同じ{IPv6送信元アドレス、IPv6宛先アドレス、フラグメント識別}を持つフラグメントが、アトミックフラグメントが同じセット{IPv6送信元アドレス、IPv6宛先アドレス、フラグメント識別}で受信され、両方のフラグメントが重複している場合、すべてのフラグメントが通知なく破棄されます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
Processing of IPv6 atomic fragments as regular fragmented packets clearly provides an unnecessary vector to perform fragmentation-based attacks against non-fragmented traffic (i.e., IPv6 datagrams that are not really split into multiple pieces but that just include a Fragment Header).
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
通常の断片化パケットとしてのIPv6アトミックフラグメントの処理は、非断片化トラフィック（つまり、実際には複数の断片に分割されておらず、単にフラグメントヘッダーを含むIPv6データグラム）に対して断片化ベースの攻撃を実行するための不必要なベクトルを提供します。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
IPv6 fragmentation attacks have been discussed in great detail in [PREDICTABLE-ID] and [CPNI-IPv6], and [RFC5722] describes a specific firewall-circumvention attack that could be performed by leveraging overlapping fragments. The possible IPv6 fragmentation-based attacks are, in most cases, &#34;ports&#34; of the IPv4 fragmentation attacks discussed in [RFC6274].
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
IPv6フラグメンテーション攻撃については、[PREDICTABLE-ID]と[CPNI-IPv6]で詳細に説明されており、[RFC5722]は、重複するフラグメントを利用して実行される可能性のある特定のファイアウォール回避攻撃について説明しています。起こりうるIPv6フラグメンテーションベースの攻撃は、ほとんどの場合、[RFC6274]で説明されているIPv4フラグメンテーション攻撃の「ポート」です。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
Section 3 describes the generation of IPv6 atomic fragments and how they can be remotely &#34;triggered&#34; by a remote attacker. Section 4 formally updates [RFC2460] and [RFC5722] such that the aforementioned attack vector is eliminated. Appendix A contains a survey of the generation and processing of IPv6 atomic fragments in different versions of a number of popular IPv6 implementations.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
セクション3では、IPv6アトミックフラグメントの生成と、リモートの攻撃者がリモートで「トリガー」する方法について説明します。セクション4では、前述の攻撃ベクトルが排除されるように、[RFC2460]と[RFC5722]を正式に更新しています。付録Aには、多くの一般的なIPv6実装のさまざまなバージョンにおけるIPv6アトミックフラグメントの生成と処理の調査が含まれています。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2" id="2--Terminology">
2. Terminology
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
2. 用語
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
IPv6 atomic fragments: IPv6 packets that contain a Fragment Header with the Fragment Offset set to 0 and the M flag set to 0.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
IPv6アトミックフラグメント：フラグメントオフセットが0に設定され、Mフラグが0に設定されたフラグメントヘッダーを含むIPv6パケット。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
The key words &#34;MUST&#34;, &#34;MUST NOT&#34;, &#34;REQUIRED&#34;, &#34;SHALL&#34;, &#34;SHALL NOT&#34;, &#34;SHOULD&#34;, &#34;SHOULD NOT&#34;, &#34;RECOMMENDED&#34;, &#34;MAY&#34;, and &#34;OPTIONAL&#34; in this document are to be interpreted as described in RFC 2119 [RFC2119].
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
このドキュメントのキーワード「MUST」、「MUST NOT」、「REQUIRED」、「SHALL」、「SHALL NOT」、「SHOULD」、「SHOULD NOT」、「RECOMMENDED」、「MAY」、および「OPTIONAL」は、 RFC 2119 [RFC2119]で説明されているように解釈されます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2" id="3--Generation-of-IPv6-Atomic-Fragments">
3. Generation of IPv6 Atomic Fragments
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
3. IPv6原子フラグメントの生成
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
Section 5 of [RFC2460] states:
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
[RFC2460]のセクション5には次のように記載されています。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-6">
&#34;In response to an IPv6 packet that is sent to an IPv4 destination (i.e., a packet that undergoes translation from IPv6 to IPv4), the originating IPv6 node may receive an ICMP Packet Too Big message reporting a Next-Hop MTU less than 1280. In that case, the IPv6 node is not required to reduce the size of subsequent packets to less than 1280, but must include a Fragment header in those packets so that the IPv6-to-IPv4 translating router can obtain a suitable Identification value to use in resulting IPv4 fragments. Note that this means the payload may have to be reduced to 1232 octets (1280 minus 40 for the IPv6 header and 8 for the Fragment header), and smaller still if additional extension headers are used.&#34;
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-6">
「IPv4宛先に送信されるIPv6パケット（つまり、IPv6からIPv4への変換を受けるパケット）に応答して、発信元のIPv6ノードは、1280未満のネクストホップMTUを報告するICMPパケットが大きすぎるメッセージを受信する場合があります。その場合、IPv6ノードは後続のパケットのサイズを1280未満に縮小する必要はありませんが、それらのパケットにフラグメントヘッダーを含めて、IPv6-to-IPv4変換ルーターが適切な識別値を取得して、結果のIPv4フラグメント。これは、ペイロードを1232オクテット（IPv6ヘッダーの場合は1280マイナス40、フラグメントヘッダーの場合は8を差し引いたもの）に削減し、追加の拡張ヘッダーを使用する場合はさらに小さくする必要がある場合があることに注意してください。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
This means that any ICMPv6 &#34;Packet Too Big&#34; message advertising a &#34;Next-Hop MTU&#34; smaller than 1280 could trigger the generation of the so-called &#34;atomic fragments&#34; (i.e., IPv6 datagrams that include a Fragment Header but that are composed of a single fragment, with both the &#34;Fragment Offset&#34; and the &#34;M&#34; fields of the Fragment Header set to 0). This can be leveraged to perform a variety of fragmentation-based attacks [PREDICTABLE-ID] [CPNI-IPv6].
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
これは、1280未満の「ネクストホップMTU」をアドバタイズするICMPv6「Packet Too Big」メッセージは、いわゆる「アトミックフラグメント」（つまり、フラグメントヘッダーを含むが、構成されているIPv6データグラム）の生成をトリガーできることを意味しますフラグメントヘッダーの「フラグメントオフセット」フィールドと「M」フィールドの両方が0に設定された単一のフラグメント。これを利用して、さまざまな断片化ベースの攻撃[予測可能ID] [CPNI-IPv6]を実行できます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-6">
For example, an attacker could forge IPv6 fragments with an appropriate {IPv6 Source Address, IPv6 Destination Address, Fragment Identification} tuple, such that these malicious fragments are incorrectly &#34;reassembled&#34; by the destination host together with some of the legitimate fragments of the original packet, thus leading to packet drops (and a potential denial of service).
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-6">
たとえば、攻撃者は適切な{IPv6送信元アドレス、IPv6宛先アドレス、フラグメント識別}タプルを使用してIPv6フラグメントを偽造し、これらの悪意のあるフラグメントが元のホストの正当なフラグメントとともに宛先ホストによって誤って「再構築」される可能性があります。したがって、パケットのドロップ（およびサービス拒否の可能性）につながります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
From a security standpoint, this situation is exacerbated by the following factors:
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
セキュリティの観点からは、この状況は次の要因によって悪化します。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
o Many implementations fail to perform validation checks on the received ICMPv6 error messages, as recommended in Section 5.2 of [RFC4443] and documented in [RFC5927]. It should be noted that in some cases, such as when an ICMPv6 error message has (supposedly) been elicited by a connectionless transport protocol (or some other connectionless protocol being encapsulated in IPv6), it may be virtually impossible to perform validation checks on the received ICMPv6 error messages.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
o [RFC4443]のセクション5.2で推奨され、[RFC5927]で文書化されているように、多くの実装では、受信したICMPv6エラーメッセージの検証チェックを実行できません。 ICMPv6エラーメッセージが（おそらく）コネクションレス型トランスポートプロトコル（またはIPv6にカプセル化されている他のコネクションレス型プロトコル）によって引き出された場合など、場合によっては、検証チェックを仮想的に実行できないことがあります。 ICMPv6エラーメッセージを受信しました。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
o Upon receipt of one of the aforementioned ICMPv6 &#34;Packet Too Big&#34; error messages, the Destination Cache [RFC4861] is usually updated to reflect that any subsequent packets to that destination should include a Fragment Header. This means that a single ICMPv6 &#34;Packet Too Big&#34; error message might affect multiple communication instances (e.g., TCP connections) with that IPv6 destination address.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
o 前述のICMPv6 &#34;Packet Too Big&#34;エラーメッセージのいずれかを受信すると、宛先キャッシュ[RFC4861]は通常、その宛先への後続のパケットにフラグメントヘッダーが含まれることを反映するように更新されます。つまり、単一のICMPv6 &#34;Packet Too Big&#34;エラーメッセージが、そのIPv6宛先アドレスを持つ複数の通信インスタンス（TCP接続など）に影響を与える可能性があります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
o Some implementations employ predictable Fragment Identification values, thus greatly improving the chances of an attacker successfully performing fragmentation-based attacks [PREDICTABLE-ID].
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
o 一部の実装では、予測可能なフラグメント識別値を採用しているため、攻撃者がフラグメント化ベースの攻撃[PREDICTABLE-ID]を成功させる可能性が大幅に向上しています。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2" id="4--Updating-RFC-2460-and-RFC-5722">
4. Updating RFC 2460 and RFC 5722
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
4. RFC 2460およびRFC 5722の更新
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
Section 4.5 of [RFC2460] and Section 4 of [RFC5722] are updated as follows:
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
[RFC2460]のセクション4.5と[RFC5722]のセクション4は次のように更新されます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-6">
A host that receives an IPv6 packet that includes a Fragment Header with the &#34;Fragment Offset&#34; equal to 0 and the &#34;M&#34; flag equal to 0 MUST process that packet in isolation from any other packets/fragments, even if such packets/fragments contain the same set {IPv6 Source Address, IPv6 Destination Address, Fragment Identification}. A received atomic fragment should be &#34;reassembled&#34; from the contents of that sole fragment.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-6">
「フラグメントオフセット」が0で「M」フラグが0のフラグメントヘッダーを含むIPv6パケットを受信するホストは、そのようなパケット/フラグメントに含まれている場合でも、他のパケット/フラグメントから分離してそのパケットを処理する必要があります。同じセット{IPv6送信元アドレス、IPv6宛先アドレス、フラグメント識別}。受信したアトミックフラグメントは、その唯一のフラグメントのコンテンツから「再構成」する必要があります。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-9">
The Unfragmentable Part of the reassembled packet consists of all headers up to, but not including, the Fragment Header of the received atomic fragment.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-9">
再構成されたパケットのフラグメント化できない部分は、受信したアトミックフラグメントのフラグメントヘッダーまでのすべてのヘッダーで構成されます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-9">
The Next Header field of the last header of the Unfragmentable Part of the reassembled packet is obtained from the Next Header field of the Fragment Header of the received atomic fragment.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-9">
再構成されたパケットのアンフラグメント化可能部分の最後のヘッダーの次ヘッダーフィールドは、受信したアトミックフラグメントのフラグメントヘッダーの次ヘッダーフィールドから取得されます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-9">
The Payload Length of the reassembled packet is obtained by subtracting the length of the Fragment Header (that is, 8) from the Payload Length of the received atomic fragment.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-9">
再構成されたパケットのペイロード長は、受信したアトミックフラグメントのペイロード長からフラグメントヘッダーの長さ（つまり、8）を差し引くことによって取得されます。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-6">
Additionally, if any fragments with the same set {IPv6 Source Address, IPv6 Destination Address, Fragment Identification} are present in the fragment reassembly queue when the atomic fragment is received, such fragments MUST NOT be discarded upon receipt of the &#34;colliding&#34; IPv6 atomic fragment, since IPv6 atomic fragments MUST NOT interfere with &#34;normal&#34; fragmented traffic.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-6">
さらに、アトミックフラグメントを受信したときに同じセット{IPv6送信元アドレス、IPv6宛先アドレス、フラグメント識別}のフラグメントがフラグメント再構成キューに存在する場合、そのようなフラグメントは、「衝突する」IPv6アトミックの受信時に破棄してはなりません（MUST NOT） IPv6のアトミックフラグメントは「通常の」フラグメント化されたトラフィックを妨害してはならないため（MUST NOT）。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2" id="5--Security-Considerations">
5. Security Considerations
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
5. セキュリティに関する考慮事項
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
This document describes how the traditional processing of IPv6 atomic fragments enables the exploitation of fragmentation-based attacks (such as those described in [PREDICTABLE-ID] and [CPNI-IPv6]). This document formally updates [RFC2460] and [RFC5722], such that IPv6 atomic fragments are processed independently of any other fragments, thus completely eliminating the aforementioned attack vector.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
このドキュメントでは、IPv6アトミックフラグメントの従来の処理が、フラグメンテーションベースの攻撃（[PREDICTABLE-ID]および[CPNI-IPv6]で説明されているものなど）の悪用を可能にする方法について説明します。このドキュメントは、[RFC2460]と[RFC5722]を正式に更新し、IPv6アトミックフラグメントが他のフラグメントとは独立して処理されるようにして、前述の攻撃ベクトルを完全に排除します。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2" id="6--Acknowledgements">
6. Acknowledgements
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
6. 謝辞
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
The author would like to thank (in alphabetical order) Tore Anderson, Ran Atkinson, Remi Despres, Stephen Farrell, Brian Haberman, Timothy Hartrick, Steinar Haug, Philip Homburg, Simon Josefsson, Simon Perreault, Sean Turner, Florian Weimer, and Bjoern A. Zeeb for providing valuable comments on earlier versions of this document. Additionally, the author would like to thank Alexander Bluhm, who implemented this specification for OpenBSD.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
著者は（アルファベット順で）Tore Anderson、Ran Atkinson、Remi Despres、Stephen Farrell、Brian Haberman、Timothy Hartrick、Steinar Haug、Philip Homburg、Simon Josefsson、Simon Perreault、Sean Turner、Florian Weimer、Bjoern Aに感謝します。このドキュメントの以前のバージョンに貴重なコメントを提供してくれたZeeb。さらに、著者は、OpenBSDにこの仕様を実装したAlexander Bluhmに感謝します。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
This document is based on the technical report &#34;Security Assessment of the Internet Protocol version 6 (IPv6)&#34; [CPNI-IPv6], authored by Fernando Gont on behalf of the UK Centre for the Protection of National Infrastructure (CPNI).
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
このドキュメントは、英国国立インフラ保護センター（CPNI）に代わってフェルナンドゴントが執筆したテクニカルレポート「インターネットプロトコルバージョン6（IPv6）のセキュリティ評価」[CPNI-IPv6]に基づいています。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
Finally, the author wishes to thank Nelida Garcia and Guillermo Gont for their love and support.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
最後に、作者は、Nelida GarciaとGuillermo Gontの愛とサポートに感謝します。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2" id="7--References">
7. References
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
7. 参考文献
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2" id="7-1--Normative-References">
7.1. Normative References
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
7.1. 引用文献
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
[RFC2119] Bradner, S., &#34;Key words for use in RFCs to Indicate Requirement Levels&#34;, BCP 14, RFC 2119, March 1997.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
[RFC2119] Bradner、S。、「要件レベルを示すためにRFCで使用するキーワード」、BCP 14、RFC 2119、1997年3月。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
[RFC2460] Deering, S. and R. Hinden, &#34;Internet Protocol, Version 6 (IPv6) Specification&#34;, RFC 2460, December 1998.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
[RFC2460] Deering、S。およびR. Hinden、「インターネットプロトコル、バージョン6（IPv6）仕様」、RFC 2460、1998年12月。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
[RFC4443] Conta, A., Deering, S., and M. Gupta, &#34;Internet Control Message Protocol (ICMPv6) for the Internet Protocol Version 6 (IPv6) Specification&#34;, RFC 4443, March 2006.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
[RFC4443]コンタ、A。、ディアリング、S。、およびM.グプタ、「インターネットプロトコルバージョン6（IPv6）仕様のインターネットコントロールメッセージプロトコル（ICMPv6）」、RFC 4443、2006年3月。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
[RFC4861] Narten, T., Nordmark, E., Simpson, W., and H. Soliman, &#34;Neighbor Discovery for IP version 6 (IPv6)&#34;, RFC 4861, September 2007.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
[RFC4861] Narten、T.、Nordmark、E.、Simpson、W。、およびH. Soliman、「Neighbor Discovery for IP version 6（IPv6）」、RFC 4861、2007年9月。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
[RFC5722] Krishnan, S., &#34;Handling of Overlapping IPv6 Fragments&#34;, RFC 5722, December 2009.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
[RFC5722] Krishnan、S。、「Handling of Overlapping IPv6 Fragments」、RFC 5722、2009年12月。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2" id="7-2--Informative-References">
7.2. Informative References
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
7.2. 参考引用
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
[CPNI-IPv6] Gont, F., &#34;Security Assessment of the Internet Protocol version 6 (IPv6)&#34;, UK Centre for the Protection of National Infrastructure, (available on request).
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
[CPNI-IPv6] Gont、F。、「インターネットプロトコルバージョン6（IPv6）のセキュリティ評価」、英国国家インフラ保護センター（リクエストに応じて入手可能）。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
[PREDICTABLE-ID] Gont, F., &#34;Security Implications of Predictable Fragment Identification Values&#34;, Work in Progress, March 2013.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
[PREDICTABLE-ID] Gont、F。、「予測可能なフラグメント識別値のセキュリティへの影響」、進行中の作業、2013年3月。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
[RFC5927] Gont, F., &#34;ICMP Attacks against TCP&#34;, RFC 5927, July 2010.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
[RFC5927] Gont、F。、「TCPに対するICMP攻撃」、RFC 5927、2010年7月。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
[RFC6274] Gont, F., &#34;Security Assessment of the Internet Protocol Version 4&#34;, RFC 6274, July 2011.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
[RFC6274] Gont、F。、「インターネットプロトコルバージョン4のセキュリティ評価」、RFC 6274、2011年7月。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-0">
Appendix A. Survey of Processing of IPv6 Atomic Fragments by Different Operating Systems
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-0">
付録A.異なるオペレーティングシステムによるIPv6原子フラグメントの処理の調査
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
This section includes a survey of the support of IPv6 atomic fragments in popular operating systems, as tested on October 30, 2012.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
このセクションには、2012年10月30日にテストされた、一般的なオペレーティングシステムでのIPv6アトミックフラグメントのサポートの調査が含まれています。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-12">
        <pre class="text text-monospace">
   +---------------------+---------------------+-----------------------+
   |   Operating System  |   Generates atomic  |    Implements this    |
   |                     |      fragments      |     specification     |
   +---------------------+---------------------+-----------------------+
   |     FreeBSD 8.0     |          No         |           No          |
   +---------------------+---------------------+-----------------------+
   |     FreeBSD 8.2     |         Yes         |           No          |
   +---------------------+---------------------+-----------------------+
   |     FreeBSD 9.0     |         Yes         |           No          |
   +---------------------+---------------------+-----------------------+
   |    Linux 3.0.0-15   |         Yes         |          Yes          |
   +---------------------+---------------------+-----------------------+
   |      NetBSD 5.1     |          No         |           No          |
   +---------------------+---------------------+-----------------------+
   |    NetBSD-current   |          No         |          Yes          |
   +---------------------+---------------------+-----------------------+
   |   OpenBSD-current   |         Yes         |          Yes          |
   +---------------------+---------------------+-----------------------+
   |      Solaris 11     |         Yes         |          Yes          |
   +---------------------+---------------------+-----------------------+
   |    Windows XP SP2   |         Yes         |           No          |
   +---------------------+---------------------+-----------------------+
   |    Windows Vista    |         Yes         |           No          |
   |     (Build 6000)    |                     |                       |
   +---------------------+---------------------+-----------------------+
   |    Windows 7 Home   |         Yes         |           No          |
   |       Premium       |                     |                       |
   +---------------------+---------------------+-----------------------+
        </pre>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-6">
Table 1: Processing of IPv6 Atomic Fragments by Different OSes
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-6">
表1：異なるOSによるIPv6原子フラグメントの処理
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-6">
In the table above, &#34;generates atomic fragments&#34; notes whether an implementation generates atomic fragments in response to received ICMPv6 &#34;Packet Too Big&#34; error messages that advertise an MTU smaller than 1280 bytes.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-6">
上記の表の「アトミックフラグメントを生成する」は、MTUが1280バイトより小さいことを通知する受信したICMPv6「パケットが大きすぎます」エラーメッセージに応じて、実装がアトミックフラグメントを生成するかどうかを示しています。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-0">
Author&#39;s Address
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-0">
著者のアドレス
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
Fernando Gont Huawei Technologies Evaristo Carriego 2644 Haedo, Provincia de Buenos Aires 1706 Argentina
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
Fernando Gont Huawei Technologies Evaristo Carriego 2644ブエノスアイレス州ハエド1706アルゼンチン
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-12">
        <pre class="text text-monospace">
   Phone: +54 11 4650 8472
   EMail: fgont@si6networks.com
        </pre>
      </div>

    </div>
  </div>
  <div id="rfc_footer"></div>
</body>
</html>
